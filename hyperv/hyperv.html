<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper-V</title>
    <link rel="stylesheet" href="../styles.css"> <!-- Optional: Link to external CSS -->
</head>
<body>

    <header>
        <h1>Hyper-V</h1>
    </header>

    <main>
        <details>
            <summary>HyperV</summary>
            <div>
                <details>
                    <summary>Update VM-W11-SYSPREP</summary>
                    <div>
                        <ol class="checklist numbered">
                            <li><label><input type="checkbox"><span>7-Zip > Right-click "C:\Users\...\Downloads\OS\VM-W11-SYSPREP\MMxYYYY\VM-W11-SYSPREP.7z.001" > 7-Zip > Extract Files... > "C:\HyperV\VM-W11-SYSPREP" > Unselect creating a folder > Select 'Eliminate duplication of root folder' > Overwrite Mode: Overwrite without prompt > Background</span></label></li>
                            <li><label><input type="checkbox"><span>Start VM-W11-SYSPREP</span></label></li>
                            <li><label><input type="checkbox"><span>Ctrl+Shift+F3 to access Audit Mode at start of OOBE</span></label></li>
                            <li><label><input type="checkbox"><span><a href="updateSysprep.ps1" download>Update SYSPREP Script.</a></span></label></li>
                            <li><label><input type="checkbox"><span>If the script is successful then skip to Delete all checkpoints...</span></label></li>
                            <li><label><input type="checkbox"><span>Settings > Windows Update > Check for updates</span></label></li>
                            <li><label><input type="checkbox"><span>Restart using the Windows Update prompt</span></label></li>
                            <li><label><input type="checkbox"><span>Settings > Windows Update > Check for updates</span></label></li>
                            <li><label><input type="checkbox"><span>Terminal (not admin)</span></label></li>
                            <pre><code>
winget update
winget update --all
                            </code></pre>
                            <li><label><input type="checkbox"><span>Settings > System > Storage > Temporary Files > Remove Files</span></label></li>
                            <li><label><input type="checkbox"><span>Cleanup winget in Admin terminal</span></label></li>
                            <pre><code>
Get-AppxPackage -AllUsers | Where-Object { $_.PackageFullName -like '*Microsoft.Winget.Source*' } | Remove-AppxPackage
                            </code></pre>
                            <li><label><input type="checkbox"><span>Shutdown</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SYSPREP > Delete all checkpoints</span></label></li>
                            <li><label><input type="checkbox"><span>Compact VHDX in Admin terminal</span></label></li>
                            <pre><code>
Optimize-VHD -Path "C:\HyperV\VM-W11-SYSPREP\Virtual Hard Disks\VM-W11-SYSPREP.vhdx" -Mode Full
                            </code></pre>
                            <li><label><input type="checkbox"><span>7zip > "C:\HyperV\VM-W11-SYSPREP\Virtual Hard Disks" > Right-click VM-W11-SYSPREP.vhdx > Add to archive... > C:\Users\...\Downloads\OS\VM-W11-SYSPREP\MMxYYYY > Split to 1000M > Background</span></label></li>
                            <li><label><input type="checkbox"><span>Start VM-W11-SYSPREP</span></label></li>
                            <li><label><input type="checkbox"><span>Ctrl+Shift+F3 to access Audit Mode at start of OOBE</span></label></li>
                            <li><label><input type="checkbox"><span><a href="unattend.xml" download>Unattend xml (Save here <strong>C:\Windows\System32\Sysprep\</strong>).</a></span></label></li>
                            <li><label><input type="checkbox"><span>Admin Powershell to check SHA256</span></label></li>
                            <pre><code>
if ((Get-FileHash "C:\Windows\System32\Sysprep\unattend.xml" -Algorithm SHA256).Hash -eq "5FEE2B1A28CE90A8CAAD81F05B343D40B598E37E93BE08BB56C3825E78CAC1DF") { "Hash matches" } else { "Hash does NOT match" }
                            </code></pre>
                            <li><label><input type="checkbox"><span>Run SysPrep in Admin terminal</span></label></li>
                            <pre><code>
C:\Windows\System32\Sysprep\sysprep.exe /generalize /oobe /shutdown /unattend:C:\Windows\System32\Sysprep\unattend.xml
                            </code></pre>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SYSPREP > Delete all checkpoints</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SYSPREP > Settings > Management > Name > Update the Notes</span></label></li>
                        </ol>
                    </div>
                </details>
                <details>
                    <summary>Depoly SBX from SYSPREP</summary>
                    <div>
                        <ol class="checklist numbered">
                            <li><label><input type="checkbox"><span></span><a href="deployVMfromSYSPREP.ps1" download>Deploy VM from SYSPREP by script.</a></span></label></li>
                            <li><label><input type="checkbox"><span>Admin Powershell to check SHA256</span></label></li>
                            <pre><code>
$h="B20609F75130DB6EA41A9C8DB844E18E4B085246E4606957A0335DA7A12EBCC4";$p=(Read-Host "Path to .ps1 file").Trim('"');if(Test-Path $p){if((Get-FileHash $p -Algorithm SHA256).Hash -eq $h){"Hash matches"}else{"Hash does NOT match"}}else{"File not found"}
                            </code></pre>
                            <li><label><input type="checkbox"><span>Connect to each SBX in turn and complete the following.</span></label></li>
                            <li><label><input type="checkbox"><span>Settings > Network... > Ethernet > IP Assignment > Manual > Add necessary IP info. </span></label></li>
                            <li><label><input type="checkbox"><span>Admin Terminal for Win11Debloat</span></label></li>
                                <pre><code>C:\Scripts\Win11Debloat.ps1</code></pre>
                            <li><label><input type="checkbox"><span>Settings > System > Rename > Update the Hostname > Save > Shutdown </span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Delete automatic checkpoint</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Settings > Security > Enable Shielding</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Checkpoint > Rename to START HERE</span></label></li>
                      </ol>
                    </div>
                </details>
                <details>
                    <summary>Update VM-W11-SBX-##</summary>
                    <div>
                        <ol class="checklist numbered">
                            <li><label><input type="checkbox"><span>Revert to START HERE checkpoint</span></label></li>
                            <li><label><input type="checkbox"><span>Start VM-W11-SBX-##</span></label></li>
                            <li><label><input type="checkbox"><span>Settings > Windows Update > Check for updates</span></label></li>
                            <li><label><input type="checkbox"><span>Restart using the Windows Update prompt</span></label></li>
                            <li><label><input type="checkbox"><span>Settings > Windows Update > Check for updates</span></label></li>
                            <li><label><input type="checkbox"><span>Terminal (not admin)</span></label></li>
                            <pre><code>
winget update
winget update --all
                            </code></pre>
                            <li><label><input type="checkbox"><span>Settings > System > Storage > Temporary Files > Remove Files</span></label></li>
                            <li><label><input type="checkbox"><span>Shutdown</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Delete START HERE checkpoint</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Checkpoint > Rename to START HERE</span></label></li>
                            <li><label><input type="checkbox"><span>HyperV Manager > VM-W11-SBX-## > Settings > Management > Name > Update the Notes</span></label></li>
                        </ol>
                    </div>
                </details>
            </div>
        </details>
    </main>
    
    <header>
        <h1></h1>
    </header>

    <main>
    </main>
    
    <footer>
        <p>&copy; 2025 Tech2Trust</p>
    </footer>

</body>
</html>
